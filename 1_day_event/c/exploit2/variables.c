#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

int main (int argc, char **argv) {

        char overwrite[24]="DC612 Day";
        char test[5]="12345";
        char buffer[128];

        printf ("Welcome to DC612 1-Day event!\n\tStack Overflow Lvl 3\n");
        printf ("Continue to overflow buffers, but be wary to keep existing data!\n");

        gets(buffer);

        if (strncmp(overwrite, "DC612 Day", 9)==0) {
                printf ("Sorry try again...\n");
                exit(1);
        } else {
                if (strncmp(test, "12345", 5)==0) {
                        printf ("Sorry, remeber to watch for other variables\nJust filling the buffer will not work 
here\n");
                        exit(1);
                } else {
			setuid(0);
			setgid(0);
			system("/bin/bash");
                        exit(0);
                }
        }
        exit(1);

}
